
@{
    ViewBag.Title = "ViewCustomerList";
}


<script type="text/javascript">

    $(document).ready(function () {
        Fn_Get_All_Customer();
    });



    function Fn_Get_All_Customer() {

        var clsCustomer = {};
        var html = "";
        $("#tbody").html("");

        $.ajax({
            type: "POST",
            url: "/MasterEntry/Fn_Get_All_Customer",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            data: JSON.stringify(clsCustomer),
            success: function (data) {
                var obj = JSON.parse(data.message);
                if (obj[0].vErrorMsg == "Success") {
                    for (var i = 0; i < obj.length; i++) {
                        html += "<tr>";
                        html += "<td>" + obj[i].ID + "</td>";
                        html += "<td>" + obj[i].vName + "</td>";
                        html += "<td>" + obj[i].CodeNo + "</td>";
                        html += "<td>" + obj[i].vAddress + "</td>";
                        html += "<td>" + obj[i].vContact + "</td>";
                        html += "<td><a href='javascript:void(0);' class='btn btn-xs sharp btn-info edit'><i class='fa fa-edit' style='align-content:center;' onclick='Fn_NavigateToEditCustomer(" + obj[i].ID + ")'></i><a href='javascript:void(0);' class='btn btn-xs sharp btn-danger trash'><i class='fa fa-trash' style='align-content:center;' onclick='Fn_Delete_CustomerDetails_ById(" + obj[i].ID + ")'></i></td>";
                        html += "</tr>";
                    }
                }
                else {
                    html += "<tr><td colspan='12' class='text-center'>No Customer Records Found.</td></tr>";
                }
                $("#tbody").append(html);
            },
            error: function (err) {
                alert(err);
            }
        });
    }


    function Fn_Delete_CustomerDetails_ById(CustomerId) {

        var clsCustomer = {};

        Swal.fire({
            title: 'Are you sure?',
            text: "Do you want to delete this Customer ID?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, Delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                clsCustomer.ID = CustomerId;
                clsCustomer.CustDeletionStatus = "Inactive";
                clsCustomer.ModifiedBy = sessionStorage.getItem("LogInID");

                $.ajax({
                    type: "POST",
                    url: "/MasterEntry/Fn_Delete_CustomerDetails_ById",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    data: JSON.stringify(clsCustomer),
                    success: function (data) {
                        var obj = JSON.parse(data.message);
                        if (obj.vErrorMsg == "Success") {
                            Swal.fire({ title: "Deleted!", text: "Customer ID has been deleted successfully.", icon: "success" });
                            Fn_Get_All_Customer();
                            return true;
                        }
                        else {
                            Swal.fire({ title: "", text: obj.vErrorMsg, icon: "error" });
                        }
                    },
                    error: function (err) {
                        alert(err);
                    }
                });
            }
            else {
                return false;
            }
        });
    }


    function Fn_NavigateToAddCustomer() {

        var AddCustomer = $("#btnAddCustomer").val();
        AddCustomer = window.location.replace("@Url.Action("AddNewCustomer", "MasterEntry")");
        return true;

    }


    function Fn_NavigateToEditCustomer(CustomerId) {

        window.location.href = "/MasterEntry/EditCustomerDetails?CID=" + CustomerId;

    }


</script>

<section id="main-content">
    <section class="wrapper">
        <div class="row page-titles mx-0">
            <span><a href="javascript:void(0);"><i class="fa fa-home"></i> <b>Home</b></a></span>
            <span><a href="javascript:void(0);"><i>></i> <b>Master</b></a></span>
            <span><a href="javascript:void(0);"><i>></i> <b>View Customer</b></a></span>
            <button class="btn btn-primary btn-xs pull-right fa fa-plus-circle fa-2x" title="Add New Customer" id="btnAddCustomer" name="btnAddCustomer" value="Add Customer" onclick="Fn_NavigateToAddCustomer();"></button>
        </div>

        <div class="row" style="margin-top: 1%;">
            <div class="col-xl-12 col-xxl-12 col-sm-12">
                <div class="card">
                    <div class="card-header">
                        <div class="col-sm-10"></div>
                        <div class="col-sm-2"></div>
                    </div>

                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover table-responsive text-nowrap">
                                <thead>
                                    <tr style="background-color: #E1C16E; background-image: linear-gradient(to bottom, #722F37, #DB5A6A); color: white;">
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Code</th>
                                        <th>Address</th>
                                        <th>Contact No</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </section>
</section>